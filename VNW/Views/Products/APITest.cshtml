
@{
    ViewData["Title"] = "APITest";
}

<h2>APITest</h2>

<h4>Get Test</h4>
<ul>
    <li><a href="/api/pp/" target="_blank">Get (list) withtou parameters</a></li>
    <li><a href="/api/pp?category=1&minPrice=100&maxPrice=200" target="_blank">Get (list) with parameter from rounte</a></li>
    <li><a href="/api/pp/1/100/300" target="_blank">Get list by Cat.|MinPrice|MaxPrice</a></li>
    <li><a href="/api/pp/1" target="_blank">Get product by id</a></li>
    <li><a href="/api/pp/girl/1" target="_blank">Search name or id</a></li>
</ul>

<hr />
<h4>Post Test</h4>
<div class="btn btn-warning" id="btn_post">POST (Add or Create) </div>

<hr />
<h4>Other Test</h4>

<div class="btn btn-warning" id="btn_put">PUT (Update) </div>

<div class="btn btn-primary" id="btn_patch">Patch (Update partially) </div>

<div class="btn btn-danger">Delete </div>

@section endJS{
    @*<!--jquery code-->*@
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        console.log("jquery start");

        $('#btn_post').click(function () {
            console.log("btn post click, jquery ajax");

            var surl = "";
            //surl = "../QuickAddStock"; //ok for /39
            //surl = "QuickAddStock";  // ok for ?id=39
            @*surl = '@(ViewBag.currentHost+ViewBag.currentBase)/products/QuickAddStock';*@
            surl = "/api/pp/";

            var productData = {
                //ProductId: 100,
                ProductName: "123",
                CategoryId: 1,
                Description: "tbd",
                UnitPrice: 100,
            };
            $.ajax({
                url: surl,
                type: "POST",
                //dateType: "json",
                contentType: "application/json",
                data: JSON.stringify(productData),
                success: function (data) {
                    console.log("get data")
                    console.log(data)
                    if (data.result == "PASS") {
                        console.log("PASS ");
                        SetReady();
                    }
                    else {
                        //::fail case
                        console.log("fail case");                        
                        SetReady();
                    }
                }, //success
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log(xhr)                    
                    SetReady();
                }//error
            });
        });

        $('#btn_put').click(btn_put_click);
        function btn_put_click() {
            console.log('btn_put_click');
            var surl = "";
            //surl = "/api/pp/";
            surl = "/api/pp/399";
            var productData = {
                ProductId: 39,
                ProductName: "123",
                CategoryId: 1,
                Description: "tbd",
                UnitPrice: 100,
            };
            $.ajax({
                url: surl,
                type: "PUT",
                //dateType: "json",
                contentType: "application/json",
                data: JSON.stringify(productData),
                success: function (data) {
                    console.log("get data")
                    console.log(data)
                    if (data.result == "PASS") {
                        console.log("PASS ");
                        SetReady();
                    }
                    else {
                        //::fail case
                        console.log("fail case");
                        SetReady();
                    }
                }, //success
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log(xhr)
                    SetReady();
                }//error
            });
        }


        $('#btn_patch').click(btn_patch_click);
        function btn_patch_click() {
            console.log('btn_put_click');
            var surl = "";
            surl = "/api/pp/";
            //surl = "/api/pp/399";
            var productData = {
                ProductId: 39,
                ProductName: "123",
                CategoryId: 1,
                Description: "tbd",
                UnitPrice: 100,
            };
            $.ajax({
                url: surl,
                type: "PATCH",
                //dateType: "json",
                contentType: "application/json",
                data: JSON.stringify(productData),
                success: function (data) {
                    console.log("get data")
                    console.log(data)
                    if (data.result == "PASS") {
                        console.log("PASS ");
                        SetReady();
                    }
                    else {
                        //::fail case
                        console.log("fail case");
                        SetReady();
                    }
                }, //success
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log(xhr)
                    SetReady();
                }//error
            });
        }


        function SetReady() {

        }
        function SetBusy() {

        }

        console.log("jquery end");

    </script>
}